(this["webpackJsonppool-registry"]=this["webpackJsonppool-registry"]||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return x}));var c=n(68),a=n(53);const s="SP1K1A1PMGW2ZJCNF46NWZWHG8TS1D23EGH1KNK60",r="pool-registry-v1",o="SP000000000000000000002Q6VF78",i="bns",l="https://app.blockstack.org",d="https://stacks-node-api.mainnet.stacks.co",u="ws://stacks-node-api.mainnet.stacks.co/",j=`${d}/v2/accounts`,b=new a.a({url:d}),p=d,m=new c.Configuration({basePath:p}),f=new c.AccountsApi(m),O=new c.SmartContractsApi(m),x=new c.TransactionsApi(m);new c.InfoApi(m)},135:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(2),a=n(28),s=n(10),r=n(1),o=n(0);function i({userSession:e,setStatus:t,setTxId:n}){const[i,l]=Object(c.useState)(),{doContractCall:d}=Object(a.useConnect)();return Object(o.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:async()=>{l(!0);try{t("Sending transaction");const c=[];await d({contractAddress:"SP000000000000000000002Q6VF78",contractName:"pox",functionName:"revoke-delegate-stx",functionArgs:c,postConditionMode:r.p.Deny,postConditions:[],userSession:e,network:s.d,onFinish:e=>{console.log(e),t(void 0),n(e.txId),l(!1)}})}catch(c){console.log(c),t(c.toString()),l(!1)}},children:[Object(o.jsx)("div",{role:"status",className:(i?"":"d-none")+" spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Cancel pool membership"]})}},193:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var c=n(0);function a({ustx:e,className:t}){return isNaN(e)?e:Object(c.jsxs)("span",{className:t,children:[(e/1e6).toLocaleString(void 0,{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}),"\u04fe"]})}},23:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return x})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"d",(function(){return S}));var c=n(195),a=n(72),s=n(9),r=n(735),o=n(292),i=n(94),l=n(45),d=n(10);const u=d.b,j=d.e;async function b(e){const t=await Object(c.b)({contractAddress:u,contractName:j,functionName:"get-pool",functionArgs:[Object(a.b)(e)],network:d.d,senderAddress:u});return console.log(t),t.type===s.a.OptionalNone?void 0:t.value}async function p({verify:e=!1,offset:t=0}){console.log({verify:e,offset:t});const n=[...Array(10).keys()].map((e=>Object(a.b)(e+1+t))),i=await Object(c.b)({contractAddress:u,contractName:j,functionName:"get-pools",functionArgs:[Object(r.a)(n)],network:d.d,senderAddress:u});return(await Promise.all(i.list.map((async(t,c)=>{if(t.type===s.a.OptionalNone)return t;{const a=t.value;if(a.data["pool-id"]=n[c],e){const e=await x(a.data.url.data,f(a.data.name));return a.data.verified=e?Object(o.b)():Object(o.a)(),a}return a}})))).reduce(((e,t)=>(t.type===s.a.OptionalNone||e.push(t),e)),[])}function m(e){const t=e.split(".");if(t.length=2){const[e,n]=t;return console.log(t),Object(i.a)({name:Object(l.b)(e),namespace:Object(l.b)(n)})}}function f(e){return`${e.data.name.buffer.toString()}.${e.data.namespace.buffer.toString()}`}const O={"https://pool.friedger.de":"friedgerpool.id","https://planbetter.org":"planbetter.btc","www.secretlabs.com":"xversepool.id"};async function x(e,t){const n=O[e];if(n)return n===t;try{const n=await fetch(e+"/manifest.json"),c=await n.json();return console.log({manifest:c,username:t},c.author===t),c.author&&(O[e]=c.author),c.author===t}catch(c){return console.log(c),!1}}const h={};async function g(e,t){return await N(e,t,"pool-trait")?0:await N(e,t,"pool-trait-ext")?1:await N(e,t,"pool-trait-ext2")?2:-1}h[`${d.c}/pox/${d.b}/${d.e}/pool-trait`]=!0;const v=["register","register-ext","register-ext2"],y=["update","update-ext","update-ext2"];function S(e){const t=e.data.contract.type===s.a.OptionalSome?e.data.contract.value:e.data.contract.ext&&e.data.contract.ext.type===s.a.OptionalSome?e.data["extended-contract"]:e.data["extended2-contract"];return Object(s.b)(t)}async function N(e,t,n){const c=`${e}/${t}/${d.b}/${d.e}/${n}`;if(console.log({path:c}),c in h)return h[c];{let e;const t=await fetch(`${d.h}/v2/traits/${c}`);return console.log({result:t}),e=404!==t.status&&(await t.json()).is_implemented,h.path=e,e}}},263:function(e,t){},288:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var c=n(2),a=n(10),s=n(88),r=n(29),o=n(28),i=n(94),l=n(45),d=n(9),u=n(47),j=n(83),b=n(72),p=n(1),m=n(19),f=n(37),O=n(87),x=n(23),h=n(0);function g({pool:t,ownerStxAddress:n,userSession:g}){console.log(t),console.log({ownerStxAddress:n,userSession:g});const{doContractCall:v}=Object(o.useConnect)(),y=Object(c.useRef)(),S=Object(c.useRef)(),N=Object(c.useRef)(),w=Object(c.useRef)(),k=Object(c.useRef)(),[A,C]=Object(c.useState)(),[P,T]=Object(c.useState)(),[I,F]=Object(c.useState)();Object(c.useEffect)((()=>{n&&(Object(r.a)(n).catch((e=>{C("Failed to access your account",e),console.log(e)})).then((async e=>{C(void 0),console.log({acc:e})})),a.i.getAccountBalance({principal:n}).then((e=>{const t=(parseInt(e.stx.balance)-parseInt(e.stx.locked))/1e6;y.current&&(y.current.value=t)})))}),[n]);const B=t.data.contract.type===d.a.OptionalSome,R=(t.data["extended-contract"].type,d.a.OptionalSome,t.data["extended2-contract"].type,d.a.OptionalSome,Object(x.d)(t)),[U,E]=R.split("."),D=Object(d.b)(t.data.delegatee).split("."),V=D.length<2?Object(u.e)(D[0]):Object(u.a)(D[0],D[1]),L=Object(j.a)(),K=function(e){switch(e.data.payout.data){case"BTC":return"BTC";case"STX":return"STX";default:return}}(t),X=function(e,t){if(console.log({payout:e,stxAddress:t}),t)switch(e){case"BTC":return m.c32ToB58(t);case"STX":default:return t}}(K,n);console.log({poolData:t.data});const W=async()=>{k.current.classList.remove("d-none");const t=Object(b.b)(1e6*y.current.value.trim()),n=S.current.value.trim()?Object(j.b)(Object(b.b)(S.current.value.trim())):Object(j.a)(),c=function(t,n){switch(t){case"BTC":return Object(f.b)(n);case"STX":return Object(f.a)(n);default:return Object(i.a)({hashbytes:Object(l.a)(e.from([0])),version:Object(l.a)(e.from([0]))})}}(K,N.current.value.trim()),s=Object(b.b)(w.current.value.trim);try{C("Sending transaction");const e=B?[t,V,n,L]:[t,V,n,L,c,s];console.log({functionArgs:e}),await v({contractAddress:U,contractName:E,functionName:"delegate-stx",functionArgs:e,postConditionMode:p.p.Deny,postConditions:[],userSession:g,network:a.d,finished:e=>{console.log(e),C(void 0),T(e.txId),k.current.classList.add("d-none")}})}catch(r){console.log(r),C(r.toString()),k.current.classList.add("d-none")}};return Object(h.jsxs)("div",{children:[Object(h.jsx)("h5",{children:"Join the pool"}),Object(h.jsx)(O.a,{pool:t}),Object(h.jsxs)("div",{className:"NoteField",children:['Choose an amount, how much you would like to "delegately" stack through this pool (can be higher than your balance to compound future rewards if stacking indefinitely).',Object(h.jsx)("input",{type:"number",step:"any",min:"0",ref:y,className:"form-control",placeholder:"Amount in STX",onKeyUp:e=>{"Enter"===e.key&&S.current.focus()},onBlur:e=>{C(void 0)}}),Object(h.jsx)("br",{}),"Duration of your pool membership (until which BTC block)",Object(h.jsx)("input",{type:"text",ref:S,className:"form-control",placeholder:"Leave empty for indefinite duration",onKeyUp:e=>{"Enter"===e.key&&w.current.focus()},onBlur:e=>{C(void 0)}}),Object(h.jsx)("br",{}),"Locking Period (how long do you want to swim this time?)",Object(h.jsx)("input",{type:"text",ref:w,className:"form-control",placeholder:"Number of cycles",disabled:B,readOnly:t&&t.data["locking-period"].type===d.a.List,defaultValue:t&&t.data["locking-period"].type===d.a.List?t.data["locking-period"].list.map((e=>e.value.toString(10))).join(" - "):"",onKeyUp:e=>{"Enter"===e.key&&N.current.focus()},onBlur:e=>{C(void 0)}}),Object(h.jsx)("br",{}),"Payout address (how would you like to get your rewards)",Object(h.jsx)("input",{type:"text",ref:N,className:"form-control",defaultValue:X,disabled:B,onKeyUp:e=>{"Enter"===e.key&&W()},onBlur:e=>{C(void 0)}}),Object(h.jsx)("br",{}),Object(h.jsx)("div",{className:"input-group-append",children:Object(h.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:W,children:[Object(h.jsx)("div",{ref:k,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Delegate"]})})]}),Object(h.jsx)("div",{children:Object(h.jsx)(s.a,{txId:P,resultPrefix:"You joined the pool "})}),A&&Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{children:A})})]})}}).call(this,n(4).Buffer)},289:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var c=n(2),a=n(10),s=n(88),r=n(29),o=n(28),i=n(94),l=(n(45),n(6)),d=n(47),u=n(9),j=n(83),b=n(72),p=n(1),m=n(19),f=(n(37),n(290)),O=n(193),x=n(135),h=n(0);function g({delegatee:e,ownerStxAddress:t,userSession:n}){console.log({ownerStxAddress:t,userSession:n});const{doContractCall:g}=Object(o.useConnect)(),v=Object(c.useRef)(),y=Object(c.useRef)(),S=Object(c.useRef)(),N=Object(c.useRef)(),[w,k]=Object(c.useState)(),[A,C]=Object(c.useState)(),[P,T]=Object(c.useState)(),[I,F]=Object(c.useState)(),[B,R]=Object(c.useState)(),[U,E]=Object(c.useState)(!1),[D,V]=Object(c.useState)(5),[L,K]=Object(c.useState)(0),[X,W]=Object(c.useState)(0),[M,$]=Object(c.useState)(0),[z,Y]="SP000000000000000000002Q6VF78.pox".split(".");Object(c.useEffect)((()=>{if(t){Object(r.a)(t).catch((e=>{k("Failed to access your account",e),console.log(e),V(25)})).then((async e=>{k(void 0),console.log({acc:e}),V(25)})),a.i.getAccountBalance({principal:t}).then((e=>{console.log(e);const t=(parseInt(e.stx.balance)-parseInt(e.stx.locked))/1e6;R(Math.min(t,100)),K(25)}));new f.a(t,a.d).getStatus().then((e=>{T(e),W(25)})),a.k.getContractDataMapEntry({contractAddress:"SP000000000000000000002Q6VF78",contractName:"pox",mapName:"delegation-state",key:Object(l.c)(Object(i.a)({stacker:Object(d.e)(t)})),network:a.d}).then((e=>{const t=Object(l.i)(e.data);t.type===u.a.OptionalNone?F({state:void 0}):F({state:t.value}),$(25)}))}}),[t,R]);const H=!0,_=e.split("."),q=_.length<2?Object(d.e)(_[0]):Object(d.a)(_[0],_[1]),J=Object(j.a)(),G=function(e,t){if(console.log({payout:e,stxAddress:t}),t)switch(e){case"BTC":return m.c32ToB58(t);case"STX":default:return t}}("STX",t),Q=async()=>{E(!0);const e=Object(b.b)(1e6*v.current.value.trim()),t=y.current.value.trim()?Object(j.b)(Object(b.b)(y.current.value.trim())):Object(j.a)();try{k("Sending transaction");const c=[e,q,t,J];console.log({functionArgs:c}),await g({contractAddress:z,contractName:Y,functionName:"delegate-stx",functionArgs:c,postConditionMode:p.p.Deny,postConditions:[],userSession:n,network:a.d,onFinish:e=>{console.log(e),k(void 0),C(e.txId),E(!1)}})}catch(c){console.log(c),k(c.toString()),E(!1)}},Z=D+L+X+M;return Object(h.jsxs)("div",{children:[Z<100&&Object(h.jsx)("div",{class:"progress",children:Object(h.jsx)("div",{class:"progress-bar",role:"progressbar",style:{width:`${Z}%`},"aria-valuenow":Z,"aria-valuemin":"0","aria-valuemax":"100"})}),Object(h.jsx)("section",{children:I&&(I.state?Object(h.jsxs)(h.Fragment,{children:["You have joined the pool ",Object(u.b)(I.state.data["delegated-to"])," with"," ",Object(h.jsx)(O.a,{ustx:I.state.data["amount-ustx"].value}),".",Object(h.jsx)("br",{}),Object(h.jsx)(x.a,{userSession:n,setStatus:k,setTxId:C})]}):Object(h.jsx)(h.Fragment,{children:"You are not delegating to any pool."}))}),Object(h.jsxs)("section",{children:[P&&(P.stacked?Object(h.jsxs)(h.Fragment,{children:["You stacked ",Object(h.jsx)(O.a,{ustx:P.details.amount_microstx})," until cycle #",P.details.first_reward_cycle+P.details.lock_period,"."]}):Object(h.jsx)(h.Fragment,{children:"Your Stacks tokens are not locked."})),Z<100&&Object(h.jsx)("div",{role:"status",className:"spinner-border spinner-border-sm text-info align-text-top mr-2"})]}),P&&!P.stacked&&I&&!I.state&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h5",{children:"Join the pool"}),"Pool address: ",Object(h.jsx)("strong",{children:e}),Object(h.jsxs)("div",{className:"NoteField",children:['Choose an amount, how much you would like to "delegately" stack through this pool (can be higher than your balance to compound future rewards if stacking indefinitely).',Object(h.jsx)("input",{type:"number",step:"any",min:"100",ref:v,defaultValue:B,className:"form-control",placeholder:"Amount in STX",onKeyUp:e=>{"Enter"===e.key&&y.current.focus()},onBlur:e=>{k(void 0)}}),Object(h.jsx)("br",{}),"Duration of your pool membership (until BTC block)",Object(h.jsx)("input",{type:"text",ref:y,className:"form-control",placeholder:"Leave empty for indefinite duration",onKeyUp:e=>{"Enter"===e.key&&N.current.focus()},onBlur:e=>{k(void 0)}}),Object(h.jsx)("br",{}),"SPSTX06BNGJ2CP1F6WA8V49B6MYD784N6YZMK95G"===e&&Object(h.jsxs)(h.Fragment,{children:["Locking Period (how long do you want to swim this time?)",Object(h.jsx)("input",{type:"text",ref:N,className:"form-control",placeholder:"Number of cycles",disabled:H,defaultValue:2,onKeyUp:e=>{"Enter"===e.key&&S.current.focus()},onBlur:e=>{k(void 0)}}),Object(h.jsx)("br",{}),"Payout address (how would you like to get your rewards)",Object(h.jsx)("input",{type:"text",ref:S,className:"form-control",defaultValue:G,disabled:H,onKeyUp:e=>{"Enter"===e.key&&Q()},onBlur:e=>{k(void 0)}}),Object(h.jsx)("br",{})]}),Object(h.jsx)("div",{className:"input-group-append",children:Object(h.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:Q,children:[Object(h.jsx)("div",{role:"status",className:(U?"":"d-none")+" spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Delegate"]})})]}),Object(h.jsx)("div",{children:Object(h.jsx)(s.a,{txId:A,resultPrefix:"You joined the pool "})}),w&&Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{children:w})})]})]})}}).call(this,n(4).Buffer)},29:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return j}));var c=n(11),a=n(5),s=n(1),r=(n(195),n(45),n(9)),o=n(6),i=n(47),l=n(10);function d(e){const t=Object(c.b)(e),n=Object(c.f)(t);return{privateKey:t,address:Object(a.a)(s.b.MainnetSingleSig,s.a.SerializeP2PKH,1,[n])}}function u(e){return console.log(`Checking account "${e}"`),e?l.i.getAccountBalance({principal:e}).then((e=>e.stx)):Promise.reject()}async function j(e){const t=await l.k.callReadOnlyFunction({contractAddress:l.c,contractName:"bns",functionName:"resolve-principal",readOnlyFunctionArgs:{sender:e,arguments:[Object(o.c)(Object(i.e)(e))]}});if(t.okay&&"0x09"!==t.result){const e=Object(o.i)(t.result);return e.type===r.a.ResponseOk?e.value:(console.log({nameResult:t}),void console.log("No name found. Error: "+e.value.data.code.value.toString(10)))}}},37:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return u}));var c=n(1),a=n(94),s=n(45),r=n(24),o=n(19);function i(e){const t=function(e){if(e.startsWith("bc1")||e.startsWith("tb1")){const{data:t}=r.address.fromBech32(e);return 32===t.length?c.a.SerializeP2WSH:c.a.SerializeP2WPKH}{const{version:t}=r.address.fromBase58Check(e);switch(t){case 0:case 111:return c.a.SerializeP2PKH;case 5:case 196:return c.a.SerializeP2SH;default:throw new Error("Invalid pox address version")}}}(e);if(e.startsWith("bc1")||e.startsWith("tb1")){const{data:n}=r.address.fromBech32(e);return{hashMode:t,data:n}}{const{hash:n}=r.address.fromBase58Check(e);return{hashMode:t,data:n}}}function l(t){const{hashMode:n,data:c}=i(t);return Object(a.a)({hashbytes:Object(s.a)(c),version:Object(s.a)(e.from([n]))})}function d(t){const{hashMode:n,data:c}=function(e){return i(o.c32ToB58(e))}(t);return console.log({hashMode:n,data:c}),Object(a.a)({hashbytes:Object(s.a)(c),version:Object(s.a)(e.from([n]))})}function u(e){return r.address.toBase58Check(e.data.hashbytes.buffer,function(e,t=!0){switch(e){case c.a.SerializeP2PKH:return t?0:111;case c.a.SerializeP2SH:return t?5:196;default:throw new Error("Invalid hash mode")}}(e.data.version.buffer.valueOf()[0],!0))}}).call(this,n(4).Buffer)},464:function(e,t){},470:function(e,t){},471:function(e,t){},494:function(e,t){},500:function(e,t){},502:function(e,t){},514:function(e,t){},584:function(e,t){},586:function(e,t){},592:function(e,t){},593:function(e,t){},596:function(e,t){},612:function(e,t){},615:function(e,t){},619:function(e,t){},636:function(e,t){},717:function(e,t){},723:function(e,t,n){var c={"./connect-modal.entry.js":[736,4]};function a(e){if(!n.o(c,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=c[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(c)},a.id=723,e.exports=a},731:function(e,t){},733:function(e,t,n){},734:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(284),s=n.n(a),r=n(28),o=n(185),i=n(10),l=n(46),d=n(192);const u=new r.AppConfig(["store_write","publish_data"]),j=Object(l.atom)(new r.UserSession({appConfig:u})),b=Object(l.atom)(),p=Object(l.atom)(),m=()=>{const[e]=Object(l.useAtom)(j),t=Object(d.useUpdateAtom)(b),n=Object(d.useUpdateAtom)(p),a={authOrigin:i.j,onFinish:async e=>{n(e.authResponse);const c=await e.userSession.loadUserData();t(c)},userSession:e,redirectTo:"/",manifestPath:"/manifest.json",appDetails:{name:"Pool Registry",icon:"/pool-registry.png"}};return{handleOpenAuth:()=>{Object(o.b)(a)},handleSignOut:Object(c.useCallback)((()=>{null===e||void 0===e||e.signUserOut("/")}),[e]),authOptions:a}};var f=n(0);function O(e){const{handleOpenAuth:t}=m();return Object(f.jsx)("div",{className:"Landing",children:Object(f.jsx)("div",{className:"jumbotron jumbotron-fluid pt-3 mb-0",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{className:"panel-landing text-center mt-3",children:[Object(f.jsx)("h1",{className:"landing-heading",children:"Pool Registry"}),Object(f.jsx)("p",{className:"lead",children:"A simple app to join and register Stacking Pools"}),Object(f.jsxs)("p",{className:"alert alert-info  border-info",children:["Pool Registry is an"," ",Object(f.jsx)("a",{href:"https://github.com/friedger/starter-app",target:"_blank",rel:"noopener noreferrer",children:"open source"})," ","web app with the purpose of"," ",Object(f.jsx)("strong",{children:"helping everybody quickly find and join a Stacking Pool."})]}),Object(f.jsxs)("div",{className:"card mt-4 border-info",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h5",{className:"card-title",children:"About Delegated Stacking"})}),Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"col col-md-12 p-4",children:"Delegated Stacking is a way to participate in the Proof of Transfer consensus algorithm with small amounts of STX."})})]}),Object(f.jsxs)("div",{className:"card mt-4 border-info",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h5",{className:"card-title",children:"Pool Registry"})}),Object(f.jsx)("div",{className:"card-body",children:Object(f.jsxs)("p",{className:"card-text mb-3",children:["Pool Registry is a web interface to the pool registry smart contract"," ",Object(f.jsxs)("a",{href:`https://explorer.stacks.co/txid/${i.b}.${i.e}?chain=mainnet`,children:[i.b,".",i.e]}),"."]})}),Object(f.jsx)("p",{className:"card-link mb-5",children:Object(f.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:t,children:"Start now"})})]})]})})})})}function x(e){return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsxs)("div",{className:"lead row mt-5 mb-3",children:[Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto px-4",children:Object(f.jsx)("h1",{className:"card-title",children:"Overview"})}),Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto mb-3 px-4",children:"This site allows you engage with the Stacks Proof of Transfer consensus algorithm through delegated stacking."}),Object(f.jsxs)("div",{className:"col-xs-10 col-md-8 mx-auto mb-3 px-4",children:["You can learn about delegated stacking at",Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:Object(f.jsx)("a",{href:"https://stacks101.com",children:"stacks101.com"})}),Object(f.jsx)("li",{children:Object(f.jsx)("a",{href:"https://stacking.club/learn",children:"stacking.club/learn"})})]})]}),Object(f.jsxs)("div",{className:"col-xs-10 col-md-8 mx-auto mb-3 px-4",children:["Pool Registry is a web interface to the pool registry smart contract"," ",Object(f.jsxs)("a",{href:`https://explorer.stacks.co/txid/${i.b}.${i.e}?chain=mainnet`,children:[i.b,".",i.e]}),"."]})]})})}var h=n(80);function g(){const{handleSignOut:e}=m(),[t]=Object(l.useAtom)(j);return(null===t||void 0===t?void 0:t.isUserSignedIn())?Object(f.jsx)("button",{className:"btn btn-primary btn-lg",onClick:()=>{console.log("signOut"),e()},children:"Log Out"}):null}var v=n(5),y=n(29);function S(e){const[t,n]=Object(c.useState)(),[a,s]=Object(c.useState)(),[o,i]=Object(c.useState)();return Object(c.useEffect)((()=>{Object(r.getUserData)(e).then((e=>{const{address:t}=Object(y.b)(e.appPrivateKey);s(Object(v.d)(t)),n(e.profile.stxAddress.mainnet),i(e.appPrivateKey)}))}),[e]),{ownerStxAddress:t,appStxAddress:a,appPrivateKey:o}}var N=n(22),w=n.n(N),k=n(36),A=n(20),C=n(87);function P(e,t){var n;return e===(null===t||void 0===t||null===(n=t.delegation)||void 0===n?void 0:n.delegatedTo)}function T(e,t){var n;return e===(null===t||void 0===t||null===(n=t.stacking)||void 0===n?void 0:n.poxAddr)}function I({pool:e,poolId:t,userInfo:n}){const a=Object(h.c)(),s=Object(c.useRef)();return Object(f.jsx)("div",{children:e?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(C.a,{pool:e}),(!n||n.canJoin)&&Object(f.jsx)("div",{className:"input-group ",children:Object(f.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:()=>{a(`/pools/${t}`,{state:{pool:e}})},children:[Object(f.jsx)("div",{ref:s,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Join Pool"]})}),n&&P(e,n)&&Object(f.jsx)(f.Fragment,{children:"You joined this pool."}),n&&T(e,n)&&Object(f.jsx)(f.Fragment,{children:"You are stacking with this pool."})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("br",{}),"Pool does not exist.",Object(f.jsx)("br",{}),Object(f.jsx)("br",{})]})})}var F=n(23),B=n(37),R=n(9);function U(e){var t=e.payout,n=e.lockingPeriod,a=e.search,s=e.verifyUsername,r=Object(c.useState)(),o=Object(A.a)(r,2),i=o[0],l=o[1],d=Object(c.useState)(),u=Object(A.a)(d,2),j=u[0],b=u[1];Object(c.useEffect)((function(){l("Loading pools"),Object(F.b)({verify:s}).then(function(){var e=Object(k.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(void 0),console.log(t),b(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){l("Failed to get pools",e),console.log(e)}))}),[s]);var p=j&&j.filter((function(e){return(!t||e.data.payout.data===t)&&(!n||isNaN(n)||e.data["locking-period"].list.findIndex((function(e){return console.log({i:e.value,lp:n}),e.value>=n}))>=0)&&(!a||e.data.fees.data.indexOf(a)>=0||e.data["date-of-payout"].data.indexOf(a)>=0||e.data.url.data.indexOf(a)>=0||Object(F.h)(e.data.name).indexOf(a)>=0||e.data["pox-address"].list.map((function(e){return Object(B.c)(e)})).join(" ").indexOf(a)>=0||Object(R.b)(e.data.delegatee).indexOf(a)>=0)}));return Object(f.jsxs)("div",{children:[p&&p.map((function(e,t){return Object(f.jsx)(I,{pool:e,poolId:e.data["pool-id"].value},t)})),!i&&(!p||0===p.length)&&Object(f.jsx)(f.Fragment,{children:"No pools found."}),i&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{children:i})})]})}function E(e){const{ownerStxAddress:t}=S(),n=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useRef)(),[r,o]=Object(c.useState)(),[i,l]=Object(c.useState)(),[d,u]=Object(c.useState)();return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsxs)("div",{className:"lead row mt-5",children:[Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto px-4",children:Object(f.jsx)("h1",{className:"card-title",children:"List of public pools"})}),Object(f.jsxs)("div",{className:"col-xs-10 col-md-8 mx-auto px-4",children:[Object(f.jsxs)("select",{ref:n,onChange:e=>{o(e.target.value)},children:[Object(f.jsx)("option",{value:"",children:"any"}),Object(f.jsx)("option",{value:"BTC",children:"BTC"}),Object(f.jsx)("option",{value:"STX",children:"STX"})]}),Object(f.jsx)("input",{type:"number",ref:a,placeholder:"minimum locking period",onChange:e=>{l(parseInt(e.target.value.trim()))}}),Object(f.jsx)("input",{type:"text",ref:s,placeholder:"search term",onChange:e=>{u(e.target.value.trim())}}),Object(f.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:()=>{o(n.current.value),l(parseInt(a.current.value.trim())),u(s.current.value.trim())},children:"Filter"})]}),Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto mb-4 px-4",children:Object(f.jsx)(U,{ownerStxAddress:t,payout:r,lockingPeriod:i,search:d,verifyUsername:!0})}),Object(f.jsxs)("div",{className:"card col-md-8 mx-auto mt-5 mb-5 text-center px-0 border-warning",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h5",{className:"card-title",children:"Instructions"})}),Object(f.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(f.jsx)("li",{className:"list-group-item",children:"Select the pool you trust and click the join button."}),Object(f.jsx)("li",{className:"list-group-item",children:"Enter the amount, duration, and reward address to define how you would like to stack and click delegate."}),Object(f.jsx)("li",{className:"list-group-item",children:"Wait for the pool admin to do the necessary and collect your rewards."})]})]})]})})}var D=n(288);function V({poolId:e,location:t,userSession:n}){const{ownerStxAddress:a}=S(n),[s,r]=Object(c.useState)();return console.log({poolData:s}),Object(c.useEffect)((()=>{(async()=>{const t=await Object(F.a)(e);console.log(t),r(t)})()}),[e]),Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsxs)("div",{className:"lead row mt-5",children:[Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto px-4",children:Object(f.jsx)("h1",{className:"card-title",children:"Pool"})}),Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto mb-4 px-4",children:s&&Object(f.jsx)(D.a,{poolId:e,pool:s,ownerStxAddress:a,userSession:n})}),Object(f.jsxs)("div",{className:"card col-md-8 mx-auto mt-5 mb-5 text-center px-0 border-warning",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h5",{className:"card-title",children:"Instructions"})}),Object(f.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(f.jsx)("li",{className:"list-group-item",children:"Enter the amount, duration, and reward address to define how you would like to stack and click delegate."}),Object(f.jsx)("li",{className:"list-group-item",children:"Wait for the pool admin to do the necessary and collect your rewards."})]})]})]})})}var L=n(739),K=n(135);function X(e){var t=e.stxAddress,n=e.updateStatus,a=e.showAddress,s=Object(c.useRef)(),r=Object(c.useState)({account:void 0}),o=Object(A.a)(r,2),i=o[0],l=o[1],d=Object(c.useCallback)(function(){var e=Object(k.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(void 0),s.current.classList.remove("d-none"),Object(y.a)(t).then((function(e){l({account:e}),s.current.classList.add("d-none")})).catch((function(e){n("Refresh failed"),console.log(e),s.current.classList.add("d-none")}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n]);return Object(c.useEffect)((function(){Object(y.a)(t).then((function(e){l({account:e})}))}),[t]),Object(f.jsxs)(f.Fragment,{children:[t&&a&&Object(f.jsxs)(f.Fragment,{children:[t," ",Object(f.jsx)("br",{})]}),i.account&&Object(f.jsxs)(f.Fragment,{children:["Your balance: ",(parseInt(i.account.balance)/1e6).toFixed(6)," STX.",Object(f.jsx)("br",{})]}),Object(f.jsxs)("button",{className:"btn btn-outline-secondary mt-1",onClick:function(e){d(t)},children:[Object(f.jsx)("div",{ref:s,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Refresh balance"]})]})}function W(e){var t=e.stxAddresses,n=e.userSession,a=Object(c.useState)(""),s=Object(A.a)(a,2),o=s[0],i=s[1],l=Object(c.useState)(),d=Object(A.a)(l,2),u=d[0],j=d[1],b=Object(c.useState)(),p=Object(A.a)(b,2),m=p[0],O=p[1],x=Object(h.c)(),g=Object(c.useState)(!1),v=Object(A.a)(g,2),S=v[0],N=v[1];if(Object(c.useEffect)((function(){N(!0),t.ownerStxAddress&&Object(F.b)({}).then(function(){var e=Object(k.a)(w.a.mark((function e(n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(void 0),console.log(n),j(n),e.t0=O,e.next=6,Object(y.c)(t.ownerStxAddress);case 6:e.t1=e.sent,(0,e.t0)(e.t1),N(!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){i("Failed to get pools",e),N(!1),console.log(e)}))}),[t.ownerStxAddress]),!n||!t.ownerStxAddress)return Object(f.jsx)("div",{children:"Loading"});var P,T=Object(r.getUserData)(n).userData,I=T&&new L.a(T.profile),B=T&&T.username;return Object(f.jsxs)("div",{className:"Profile",children:[Object(f.jsx)("div",{className:"avatar-section text-center",children:Object(f.jsx)("img",{src:(P=I&&I.avatarUrl()||"https://s3.amazonaws.com/onename/avatar-placeholder.png","/proxy/"+P.replace(/^https?:\/\//i,"")),className:"img-rounded avatar",id:"avatar-image",alt:"Avatar"})}),Object(f.jsxs)("div",{className:"text-center mt-2",children:["Hello, ",Object(f.jsx)("span",{id:"heading-name",children:I&&I.name()||B||"Stacker"}),"!"]}),(B||m)&&Object(f.jsxs)(f.Fragment,{children:["Your Blockstack username is"," ",B||"".concat(m.data.name.buffer.toString(),".").concat(m.data.namespace.buffer.toString())," ",Object(f.jsx)("br",{})]}),Object(f.jsxs)("div",{className:"pt-4",children:["Your own Stacks address:",Object(f.jsx)("br",{}),Object(f.jsx)(X,{stxAddress:t.ownerStxAddress,updateStatus:function(e){i(e),setTimeout((function(){i(void 0)}),2e3)},showAddress:!0})]}),u&&m&&Object(f.jsx)("div",{className:"pt-4",children:u.filter((function(e){return function(e,t){return console.log({nameCV:t,pool:e}),t.data.namespace.buffer.toString()===e.data.name.data.namespace.buffer.toString()&&t.data.name.buffer.toString()===e.data.name.data.name.buffer.toString()}(e,m)})).map((function(e){return Object(f.jsxs)("div",{className:"pt-4",children:[Object(f.jsx)(C.a,{pool:e}),Object(f.jsx)("div",{className:"input-group ",children:Object(f.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){console.log(e.data["pool-id"]),x("/me/edit/".concat(e.data["pool-id"].value),{state:{pool:e}})},children:"Edit Pool"})})]})}))}),S&&Object(f.jsx)(f.Fragment,{children:"Getting your pools' data and BNS username..."}),Object(f.jsx)("div",{className:"input-group pt-4",children:Object(f.jsx)("button",{className:"btn btn-outline-secondary",type:"button",onClick:function(){x("/me/register")},children:"Register New Pool"})}),Object(f.jsxs)("div",{className:"pt-4",children:["If you want to revoke your membership of any pool, you can do it here.",Object(f.jsx)("br",{}),Object(f.jsx)(K.a,{userSession:n,setStatus:i,setTxId:function(e){return i("Revoking with transcation ".concat(e))}})]}),o&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("br",{}),Object(f.jsx)("div",{children:o})]})]})}function M({userSession:e}){console.log(e);const{ownerStxAddress:t,appStxAddress:n}=S(e);return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"mx-auto col-sm-10 col-md-8 px-4",children:Object(f.jsx)(W,{stxAddresses:{appStxAddress:n,ownerStxAddress:t},userSession:e})})})})}var $=n(88),z=n(195),Y=n(1),H=n(47),_=n(735),q=n(89),J=n(83),G=n(72),Q=n(45),Z=n(19),ee=n(38),te=n.n(ee),ne="Name must contain 1 dot.",ce="Website url required!",ae="At least one reward address required.",se="Invalid Bitcoin address(es).",re="Invalid contract id.",oe="At least one locking period required.",ie="Locking periods must be numbers between 1 and 12.",le="Invalid STX address.";function de(e){var t,n=e.ownerStxAddress,a=e.register,s=e.poolId,o="Update pool";a?(o="Register a pool",t="Register"):(o="Update pool",t="Update");var l=Object(r.useConnect)().doContractCall,d=Object(c.useRef)(),u=Object(c.useRef)(),j=Object(c.useRef)(),b=Object(c.useRef)(),p=Object(c.useRef)(),m=Object(c.useRef)(),O=Object(c.useRef)(),x=Object(c.useRef)(),h=Object(c.useRef)(),g=Object(c.useRef)(),v=Object(c.useRef)(),S=Object(c.useRef)(),N=Object(c.useRef)(),C=Object(c.useState)(),P=Object(A.a)(C,2),T=P[0],I=P[1],U=Object(c.useState)(),E=Object(A.a)(U,2),D=E[0],V=E[1],L=Object(c.useState)(),K=Object(A.a)(L,2),X=K[0],W=K[1],M=Object(c.useState)(),ee=Object(A.a)(M,2),de=ee[0],ue=ee[1],je=Object(c.useState)(),be=Object(A.a)(je,2),pe=be[0],me=be[1],fe=n?Z.c32ToB58(n):"";Object(c.useEffect)((function(){n&&(Object(y.a)(n).catch((function(e){I("Failed to access your account",e),console.log(e)})).then(function(){var e=Object(k.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log({acc:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(y.c)(n).then((function(e){W(e?"".concat(e.data.name.buffer.toString(),".").concat(e.data.namespace.buffer.toString()):void 0)})),s&&Object(F.a)(s).then((function(e){console.log({pool:e}),ue(e)})))}),[n,s]);var Oe=function(){var e=Object(k.a)(w.a.mark((function e(){var t,c,s,r,o,u,y,k,C,P,T,R,U,E,D,L,K,W,M,$,Q;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=ge()).length>0)){e.next=6;break}return I(r.map((function(e){return Object(f.jsxs)(f.Fragment,{children:[e,Object(f.jsx)("br",{})]})}))),e.abrupt("return");case 6:I(void 0);case 7:return o=m.current.value.trim().split("."),u=Object(A.a)(o,2),y=u[0],k=u[1],e.next=10,Object(F.c)(y,k);case 10:if(!((C=e.sent)<0)){e.next=14;break}return I("Invalid pool contract"),e.abrupt("return");case 14:if(!a){e.next=26;break}if(t=F.f[C],!X){e.next=20;break}s=new te.a(0),e.next=24;break;case 20:if(pe){e.next=23;break}return e.next=23,xe();case 23:s=new te.a(1e6*pe);case 24:e.next=28;break;case 26:t=F.g[C],s=new te.a(0);case 28:if(e.t0=X,!e.t0){e.next=33;break}return e.next=32,he(b.current.value.trim(),X);case 32:e.t0=!e.sent;case 33:if(!e.t0){e.next=36;break}return I('Website manifest.json must contain entry "author":"'.concat(X,'"')),e.abrupt("return");case 36:if(c=Object(z.e)(n,Y.k.Equal,s),N.current.classList.remove("d-none"),P=Object(F.e)(d.current.value.trim())){e.next=42;break}return I(ne),e.abrupt("return");case 42:if(T=j.current.value.trim().split("."),R=1===T.length?Object(H.e)(T[0]):Object(H.a)(T[0],T[1]),U=Object(_.a)(p.current.value.split(",").map((function(e){return Object(B.b)(e.trim())}))),E=Object(q.a)(b.current.value.trim()),D=O.current.value?Object(J.b)(Object(G.b)(1e6*parseInt(O.current.value))):Object(J.a)(),x.current.value.trim()){e.next=50;break}return I("Locking Period required."),e.abrupt("return");case 50:return L=x.current.value.trim()?Object(_.a)(x.current.value.split(",").map((function(e){return Object(G.b)(parseInt(e.trim()))}))):Object(_.a)([]),K=Object(q.a)(h.current.value.trim()),W=Object(q.a)(g.current.value.trim()),M=Object(q.a)(v.current.value.trim()),$=Object(H.a)(y,k),Q=Object(G.b)(S.current.value),console.log({functionName:t,lockingPeriodCV:L,poxAddressCV:U}),e.prev=57,I("Sending transaction"),e.next=61,l({contractAddress:i.b,contractName:i.e,functionName:t,functionArgs:[P,R,U,E,$,D,L,K,W,M,Q],postConditionMode:Y.p.Deny,postConditions:[c],network:i.d,finished:function(e){console.log(e),I(void 0),V(e.txId),N.current.classList.add("d-none")}});case 61:e.next=68;break;case 63:e.prev=63,e.t1=e.catch(57),console.log(e.t1),I(e.t1.toString()),N.current.classList.add("d-none");case 68:case"end":return e.stop()}}),e,null,[[57,63]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(k.a)(w.a.mark((function e(){var t,c,a,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.current.value.trim(),2!==(c=t.split(".")).length){e.next=10;break}return e.next=5,Object(z.b)({contractAddress:i.c,contractName:"bns",functionName:"get-name-price",functionArgs:[Object(Q.b)(c[1]),Object(Q.b)(c[0])],senderAddress:n});case 5:a=e.sent,console.log({priceResult:a}),a.type===R.a.ResponseOk?(s=a.value.value/1000000n,me(s),u.current.innerHTML="Price: ".concat(s.toFixed(6)," STX")):u.current.innerHTML="No price info found.",e.next=11;break;case 10:u.current.innerHTML=ne;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(k.a)(w.a.mark((function e(t,n){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(F.i)(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=[];2!==d.current.value.trim().split(".").length?(d.current.setCustomValidity(ne),e.push(ne)):d.current.setCustomValidity(""),b.current.value.trim()?b.current.setCustomValidity(""):(b.current.setCustomValidity(ce),e.push(ce));try{var t=j.current.value.trim().split("."),n=Object(A.a)(t,1)[0];Z.c32addressDecode(n),j.current.setCustomValidity("")}catch(l){console.log(l),j.current.setCustomValidity("Invalid STX address. "+l.toString()),e.push(le)}var c=p.current.value.split(",");0===c.length?(p.setCustomValidity(ae),e.push(ae)):c.reduce((function(e,t){try{return Z.b58ToC32(t.trim()),e}catch(l){return console.log(t,l),!1}}),!0)?p.current.setCustomValidity(""):(p.current.setCustomValidity(se),e.push(se));var a=m.current.value.trim().split("."),s=Object(A.a)(a,2),r=s[0],o=s[1];r&&o?m.current.setCustomValidity(""):(m.current.setCustomValidity(re),e.push(re));var i=x.current.value.split(",");return 0===i.length?(x.current.setCustomValidity(oe),e.push(oe)):i.reduce((function(e,t){var n=parseInt(t.trim());return e&&!isNaN(n)&&n>=1&&n<=12}),!0)?x.current.setCustomValidity(""):(x.current.setCustomValidity(ie),e.push(ie)),e};return Object(f.jsxs)("div",{children:[Object(f.jsx)("h5",{children:o}),(a||de&&X)&&Object(f.jsxs)("div",{className:"NoteField",children:[Object(f.jsx)("b",{children:"Pool admin's user name"}),a&&!X&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("br",{}),"A BNS name that is used to protect pool's data. Only the owner of this name can update the data. The name must contain exactly 1 dot. e.g. alice.id. Subdomain names are not supported by the UI.",Object(f.jsx)("br",{}),"The name is registered and paid for during the `register` function call if not yet owned by the caller. (Costs around 0.1 STX for friedgerpool.id)",Object(f.jsx)("br",{}),'After successful registration of the name, add the name to your website\'s manifest.json file as "author".']}),Object(f.jsx)("input",{type:"text",ref:d,className:"form-control",defaultValue:X,readOnly:!a||X,placeholder:"Name, e.g. alice.id",onKeyUp:function(e){"Enter"===e.key&&j.current.focus()},onBlur:function(e){ge()}}),a&&Object(f.jsxs)("div",{className:"input-group-append",style:{alignItems:"center"},children:[Object(f.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:xe,children:[Object(f.jsx)("div",{ref:N,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"}),"Check price"]}),Object(f.jsx)("div",{className:"pl-4",ref:u})]}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Delegatee address"}),Object(f.jsx)("br",{}),"Pool's Stacks address for delegation",Object(f.jsx)("input",{type:"text",ref:j,className:"form-control",defaultValue:a?n:Object(R.b)(de.data.delegatee),placeholder:"Stacks address",onKeyUp:function(e){"Enter"===e.key&&b.current.focus()},required:!0,onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Pool's Website"}),Object(f.jsx)("input",{type:"text",ref:b,className:"form-control",defaultValue:a?"":de.data.url.data,placeholder:"Url",required:!0,onKeyUp:function(e){"Enter"===e.key&&p.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Reward BTC addresses"}),Object(f.jsx)("br",{}),"One or more BTC addresses, comma separated list",Object(f.jsx)("input",{type:"text",ref:p,className:"form-control",defaultValue:a?fe:de.data["pox-address"].list.map((function(e){return Object(B.c)(e)})).join(","),placeholder:"Pool's reward BTC address",onKeyUp:function(e){"Enter"===e.key&&m.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Contract ID"}),Object(f.jsx)("br",{}),"This could be the genesis pox contract or a custom pool contract.",Object(f.jsx)("input",{type:"text",ref:m,className:"form-control",defaultValue:a?"".concat(i.c,".pox"):de.data.contract.type===R.a.OptionalSome?Object(R.b)(de.data.contract.value):Object(R.b)(de.data["contract-ext"].value),placeholder:"Pool's Contract ID",onKeyUp:function(e){"Enter"===e.key&&O.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Minimum STX"})," required to join",Object(f.jsx)("input",{type:"number",ref:O,step:"any",min:"0",className:"form-control",defaultValue:a?void 0:de.data["minimum-ustx"].type===R.a.OptionalSome?de.data["minimum-ustx"].value.value/1000000n:void 0,placeholder:"Minimum STX required for joining",onKeyUp:function(e){"Enter"===e.key&&x.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Locking period"}),Object(f.jsx)("br",{}),"Number of locking cycles (comma separated list of cycles; between 1 and 12). ",Object(f.jsx)("br",{}),Object(f.jsx)("del",{children:"Leave empty if variable."})," At least one entry required due to"," ",Object(f.jsx)("a",{href:"https://github.com/blockstack/stacks-wallet-web/issues/1111",children:"#1111"}),".",Object(f.jsx)("input",{type:"text",ref:x,className:"form-control",placeholder:"e.g. 1, 12",defaultValue:a?void 0:de.data["locking-period"].list.map((function(e){return e.value.toString(10)})).join(","),onKeyUp:function(e){"Enter"===e.key&&h.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Pool payouts"})," ",Object(f.jsx)("br",{}),"Currency of pool payouts",Object(f.jsxs)("select",{type:"text",ref:h,className:"form-control",defaultValue:a?"BTC":de.data.payout.data,placeholder:"e.g. BTC, STX, WMNO",onKeyUp:function(e){"Enter"===e.key&&g.current.focus()},onBlur:function(e){ge()},children:[Object(f.jsx)("option",{value:"BTC",children:"BTC"}),Object(f.jsx)("option",{value:"STX",children:"STX"})]}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Date of Payout"}),Object(f.jsx)("br",{}),"When the Pool payouts rewards (optional, max 80 char.)",Object(f.jsx)("input",{type:"text",ref:g,className:"form-control",defaultValue:a?"":de.data["date-of-payout"].data,placeholder:"e.g. end of cycle, instant",maxLength:"80",onKeyUp:function(e){"Enter"===e.key&&v.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Fees"}),Object(f.jsx)("br",{}),"What are the fees (optional, max 80 char.)",Object(f.jsx)("input",{type:"text",ref:v,className:"form-control",defaultValue:a?"":de.data.fees.data,placeholder:"e.g. 10%, 5 STX",maxLength:"80",onKeyUp:function(e){"Enter"===e.key&&S.current.focus()},onBlur:function(e){ge()}}),Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"Status"}),Object(f.jsx)("br",{}),'One of "In development", "In production", "Open to join", "Closed for next cycle", "Retired"',Object(f.jsxs)("select",{ref:S,className:"form-control",defaultValue:a?"0":de.data.status.value,onKeyUp:function(e){"Enter"===e.key&&Oe()},onBlur:function(e){ge()},children:[Object(f.jsx)("option",{value:"0",children:"In development (0)"}),Object(f.jsx)("option",{value:"1",children:"In production (1)"}),Object(f.jsx)("option",{value:"11",children:"Open to join for next cycle (11)"}),Object(f.jsx)("option",{value:"21",children:"Closed for next cycle (21)"}),Object(f.jsx)("option",{value:"99",children:"Retired (99)"})]}),Object(f.jsx)("br",{}),Object(f.jsx)("div",{className:"input-group-append",children:Object(f.jsxs)("button",{className:"btn btn-outline-secondary",type:"button",onClick:Oe,children:[Object(f.jsx)("div",{ref:N,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"}),t]})})]}),!a&&!de&&Object(f.jsx)(f.Fragment,{children:"Loading pool data..."}),Object(f.jsx)("div",{children:Object(f.jsx)($.a,{txId:D,resultPrefix:"Order placed in block "})}),T&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{children:T})})]})}function ue({userSession:e}){console.log(e);const{ownerStxAddress:t}=S(e);return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"mx-auto col-sm-10 col-md-8 px-4",children:Object(f.jsx)(de,{register:!0,ownerStxAddress:t})})})})}function je({userSession:e,poolId:t}){console.log({userSession:e,poolId:t});const{ownerStxAddress:n}=S(e);return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsx)("div",{className:"mx-auto col-sm-10 col-md-8 px-4",children:Object(f.jsx)(de,{ownerStxAddress:n,poolId:t})})})})}var be=n(289);function pe({delegatee:e,location:t,userSession:n}){const{ownerStxAddress:c}=S(n);return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsxs)("div",{className:"lead row mt-5",children:[Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto px-4",children:Object(f.jsx)("h1",{className:"card-title",children:"Join Pool"})}),Object(f.jsx)("div",{className:"col-xs-10 col-md-8 mx-auto mb-4 px-4",children:Object(f.jsx)(be.a,{delegatee:e,ownerStxAddress:c,userSession:n})}),Object(f.jsxs)("div",{className:"card col-md-8 mx-auto mt-5 mb-5 text-center px-0 border-warning",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h5",{className:"card-title",children:"Instructions"})}),Object(f.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(f.jsx)("li",{className:"list-group-item",children:"If you have not yet locked any Stacks tokens and if you haven't joined a pool yet, join now."}),Object(f.jsx)("li",{className:"list-group-item",children:"Enter the amount, duration, and reward address to define how you would like to stack and click delegate."}),Object(f.jsx)("li",{className:"list-group-item",children:"Wait for the pool admin to do the necessary and collect your rewards."})]})]})]})})}var me=n(53);function fe(e){var t=e.userSession,n=S(t),a=n.ownerStxAddress,s=n.appStxAddress,r=n.appPrivateKey,o=Object(c.useState)(),i=Object(A.a)(o,2),l=i[0],d=i[1],u=Object(c.useState)(!0),j=Object(A.a)(u,2),b=j[0],p=j[1],m=function(){var e=Object(k.a)(w.a.mark((function e(){var t,n,c,o,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("Checking balances.."),e.next=3,Object(y.a)(s);case 3:if("0"!==(t=e.sent).balance){e.next=7;break}return d("Amount is 0"),e.abrupt("return");case 7:return n=new me.a,c=1e5,e.next=11,Object(z.d)({amount:new te.a(t.balance-c),recipient:a,network:n,fee:new te.a(c),senderKey:r});case 11:if(o=e.sent,!b){e.next=17;break}d("Transfer ".concat(t.balance," from ").concat(s," to ").concat(a,". Using ").concat(c/1e6," STX as transaction fees.")),p(!1),e.next=21;break;case 17:return e.next=19,Object(z.a)(o,n);case 19:i=e.sent,d("Transfer has been submitted "+i);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsx)("main",{className:"panel-welcome mt-5 container",children:Object(f.jsx)("div",{className:"row",children:Object(f.jsxs)("div",{className:"mx-auto col-sm-10 col-md-8 px-4",children:[Object(f.jsx)(W,{stxAddresses:{appStxAddress:s,ownerStxAddress:a},userSession:t}),Object(f.jsxs)("div",{className:"pt-4",children:["Your STX hold address for this pool app:",Object(f.jsx)("br",{}),Object(f.jsx)(X,{stxAddress:s,showAddress:!0,updateStatus:d})]}),Object(f.jsx)("hr",{}),Object(f.jsx)("div",{children:"Transfer from Hodl account address to Stx account address"}),Object(f.jsx)("button",{className:"btn btn-outline-secondary mt-1",onClick:m,children:b?"Preview":"Transfer"}),Object(f.jsx)("div",{children:l})]})})})}function Oe(e){const{authOptions:t}=m(),[n]=Object(l.useAtom)(j),[,a]=Object(l.useAtom)(b);return Object(c.useEffect)((()=>{(null===n||void 0===n?void 0:n.isUserSignedIn())?a(n.loadUserData()):n.isSignInPending()&&n.handlePendingSignIn()}),[n,a]),Object(f.jsxs)(r.Connect,{authOptions:t,children:[Object(f.jsxs)("nav",{className:"navbar sticky-top navbar-dark bg-dark text-light",children:[Object(f.jsx)("a",{className:"navbar-brand",href:"/",children:Object(f.jsx)("img",{src:"/mainnet.png",alt:"Logo"})}),Object(f.jsx)(g,{className:"ml-auto",userSession:n})]}),Object(f.jsx)(ge,{userSession:n})]})}const xe=e=>Object(f.jsx)(h.a,{...e,getProps:({isCurrent:e})=>e?{className:"nav-item nav-link px-4 active"}:{className:"nav-item nav-link px-4"}});function he(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("nav",{className:"navbar navbar-expand-md nav-pills nav-justified mx-auto",children:[Object(f.jsx)(xe,{to:"/",children:"Overview"}),Object(f.jsx)(xe,{to:"/pools",children:"Pools"}),Object(f.jsx)(xe,{to:"/me",children:"Profile"})]}),e.children,Object(f.jsx)("div",{children:i.d.coreApiUrl})]})}function ge({userSession:e}){const t=e&&e.isUserSignedIn(),n=e&&e.isUserSignedIn()&&e.loadUserData().decentralizedID;return Object(f.jsxs)(f.Fragment,{children:[!t&&Object(f.jsx)(O,{}),n&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(h.b,{children:Object(f.jsxs)(he,{path:"/",children:[Object(f.jsx)(x,{path:"/",decentralizedID:n}),Object(f.jsx)(E,{path:"/pools",decentralizedID:n,userSession:e}),Object(f.jsx)(V,{path:"/pools/:poolId",decentralizedID:n,userSession:e}),Object(f.jsx)(M,{path:"/me",decentralizedID:n,userSession:e}),Object(f.jsx)(ue,{path:"/me/register",decentralizedID:n,userSession:e}),Object(f.jsx)(je,{path:"/me/edit/:poolId",decentralizedID:n,userSession:e}),Object(f.jsx)(pe,{path:"/join/:delegatee",decentralizedID:n,userSession:e}),Object(f.jsx)(fe,{path:"/hodl",decentralizedID:n,userSession:e})]})})})]})}n(732),n(733);s.a.render(Object(f.jsx)(Oe,{}),document.getElementById("App"))},87:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var c=n(9),a=n(23),s=n(37),r=n(0);function o(e){var t,n=e.pool,o=Object(a.d)(n);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("h5",{children:[n.data.url.data?Object(r.jsx)("a",{href:(t=n.data.url.data,t.startsWith("https://")||t.startsWith("http://")?t:"https://".concat(t)),children:Object(a.h)(n.data.name)}):Object(r.jsx)(r.Fragment,{children:Object(a.h)(n.data.name)}),n.data.verified&&n.data.verified.type===c.a.BoolTrue&&Object(r.jsxs)(r.Fragment,{children:[" ",Object(r.jsx)("a",{href:"".concat(n.data.url.data,"/manifest.json"),children:Object(r.jsx)("img",{src:"/verified.svg",alt:"verified",width:"16"})})]})]}),Object(r.jsxs)("p",{children:[Object(c.b)(n.data.delegatee),Object(r.jsx)("br",{}),n.data["locking-period"].type===c.a.List?"Locking for ".concat(n.data["locking-period"].list.map((function(e){return e.value.toString(10)})).join(", ")," cycles."):"Variable locking period",Object(r.jsx)("br",{}),n.data["minimum-ustx"].type===c.a.OptionalSome?"Minimum amount required to join: ".concat(n.data["minimum-ustx"].value.value/1000000n," STX"):"No minimum STX required.",Object(r.jsx)("br",{}),"Payout in ",n.data.payout.data,".",Object(r.jsx)("br",{}),n.data["date-of-payout"].data?Object(r.jsxs)(r.Fragment,{children:["When payout? ",n.data["date-of-payout"].data,"."]}):Object(r.jsx)(r.Fragment,{children:"No information about payout date available."}),Object(r.jsx)("br",{}),n.data.fees.data?"Fees: ".concat(n.data.fees.data):"No information about fees available.",Object(r.jsx)("br",{}),"Reward addresses:",Object(r.jsx)("br",{}),n.data["pox-address"].list.map((function(e){return Object(r.jsxs)(r.Fragment,{children:[Object(s.c)(e),Object(r.jsx)("br",{})]})})),"Using contract:",Object(r.jsx)("br",{}),o,Object(r.jsx)("br",{})]})]})}},88:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(93),n(6);var c=n(68),a=n(2),s=n(10),r=n(0);function o({txId:e,resultPrefix:t}){const[n,o]=Object(a.useState)({loading:!1}),i=Object(a.useRef)();if(Object(a.useEffect)((()=>{if(!e)return;let t;console.log(e),i.current.classList.remove("d-none"),o({loading:!0});(async(e,n)=>{try{const a=await Object(c.connectWebSocketClient)(s.g);t=await a.subscribeTxUpdates(e,n),console.log({client:a,sub:t})}catch(a){console.log(a)}})(e,(async n=>{let c;if(console.log(n),"pending"!==n.tx_status){if("success"===n.tx_status){const t=await s.l.getTransactionById({txId:e});console.log(t),c=t.tx_result}else n.tx_status.startsWith("abort")&&(c=void 0);i.current.classList.add("d-none"),o({loading:!1,result:c}),await t.unsubscribe()}}))}),[e]),!e)return null;const l=e.startsWith("0x")?e:`0x${e}`;return Object(r.jsxs)(r.Fragment,{children:[n.loading&&Object(r.jsxs)(r.Fragment,{children:["Checking transaction status:"," ",Object(r.jsx)("a",{href:`https://explorer.stacks.co/txid/${l}?chain=mainnet`,children:l})]}),!n.loading&&n.result&&Object(r.jsxs)(r.Fragment,{children:[t,n.result.repr]})," ",Object(r.jsx)("div",{ref:i,role:"status",className:"d-none spinner-border spinner-border-sm text-info align-text-top mr-2"})]})}}},[[734,2,3]]]);
//# sourceMappingURL=main.497472c5.chunk.js.map